const core = require('@actions/core');
const run = require('../src/tangle-release');

describe('Tangle Release', () => {
  let setFailedMock;
  beforeEach(() => {
    jest.spyOn(console, 'log').mockImplementation();
    setFailedMock = jest.spyOn(core, 'setFailed');
  });

  afterAll(() => {
    jest.clearAllMocks();
  });

  test('No IOTA_SEED', async () => {
    await run();
    expect(setFailedMock).toHaveBeenCalledWith('You must provide the IOTA_SEED env variable');
  });

  test('No IOTA_SEED 2', async () => {
    process.env.IOTA_SEED = 'A'.repeat(81);
    await run();
    expect(setFailedMock).toHaveBeenCalledWith('aYou must provide the IOTA_SEED env variable');
  });
});
